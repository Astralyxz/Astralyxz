<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Econom√≠a Interna de Astralyxz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
    <!-- 
        Chosen Palette: Strategic Teal & Gold + Corporate Blue & Neutral Gray
        Application Structure Plan: This is a merged document. It retains the main SPA structure of "astralyxz_economy_spa" (interactive diagram) and integrates the functional "Raffle Profitability Simulator" component from "simulador_rentabilidad_standalone". The integration replaces the non-functional calculator section with the working one, creating a single, cohesive application.
        Visualization & Content Choices:
        - The application maintains the interactive flow diagram and detail panel from the original code.
        - The calculator section is now implemented with HTML range sliders and a Chart.js Bar Chart for a more interactive and functional experience, as per the working component.
        CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.
    -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
            color: #343a40;
        }
        .diagram-node {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .diagram-node:hover, .diagram-node.active {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(17, 138, 178, 0.4);
            border-color: #0d9488;
        }
        .flow-arrow {
            position: relative;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
        }
        .flow-arrow::after {
            content: '‚Üí';
            font-size: 2.5rem;
            line-height: 1;
        }
        @media (max-width: 767px) {
            .flow-arrow::after {
                content: '‚Üì';
                font-size: 2rem;
            }
        }
        .detail-panel-content {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 280px;
            max-height: 280px;
        }
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 5px;
            outline: none;
            transition: background 0.3s;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #3182ce;
            cursor: pointer;
            border-radius: 50%;
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #3182ce;
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto px-4 py-8 md:py-12">
        <header class="text-center mb-10 md:mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800">TE AMO LARA!!</h1>
            <p class="text-xl text-teal-700 mt-2 font-medium">An√°lisis Interactivo del Modelo Astralyxz Coin (AC)</p>
        </header>

        <section id="economic-flow" class="mb-12">
            <p class="text-center text-gray-600 mb-8 max-w-3xl mx-auto">El siguiente diagrama representa el ciclo de vida de la Astralyxz Coin. Haga clic en cada etapa para explorar en detalle c√≥mo se emiten, circulan y controlan las monedas dentro de la plataforma.</p>
            <div class="flex flex-col md:flex-row items-center justify-center gap-4 md:gap-0">
                <div data-target="emission" class="diagram-node w-full md:w-1/4 bg-white p-4 rounded-lg shadow-md border-2 border-transparent text-center">
                    <span class="text-4xl"> üí∏ </span>
                    <h3 class="font-bold text-lg mt-2">EMISI√ìN</h3>
                    <p class="text-xs text-gray-500">Creaci√≥n de Coins</p>
                </div>
                <div class="flow-arrow w-full md:w-1/12 h-16 md:h-auto"></div>
                <div data-target="circulation" class="diagram-node w-full md:w-1/4 bg-white p-4 rounded-lg shadow-md border-2 border-transparent text-center">
                     <span class="text-4xl"> üîÑ </span>
                    <h3 class="font-bold text-lg mt-2">CIRCULACI√ìN</h3>
                    <p class="text-xs text-gray-500">Uso de Coins</p>
                </div>
                 <div class="flow-arrow w-full md:w-1/12 h-16 md:h-auto"></div>
                <div data-target="control" class="diagram-node w-full md:w-1/4 bg-white p-4 rounded-lg shadow-md border-2 border-transparent text-center">
                    <span class="text-4xl"> üõ°Ô∏è </span>
                    <h3 class="font-bold text-lg mt-2">CONTROL</h3>
                    <p class="text-xs text-gray-500">Reglas y Riesgos</p>
                </div>
            </div>
        </section>
        
        <main id="detail-panel" class="min-h-[300px] bg-white/70 p-6 md:p-8 rounded-xl shadow-lg border border-gray-200 mb-12">
        </main>

        <!-- Seccion del Simulador integrada y funcional -->
        <section id="simulator" class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-gray-200 mb-12">
            <h2 class="text-2xl font-bold text-center mb-2 text-gray-800">Simulador de Rentabilidad de Rifas</h2>
            <p class="text-center text-sm text-gray-500 mb-6 max-w-2xl mx-auto">Ajusta los par√°metros para calcular el precio m√≠nimo por ticket necesario para alcanzar el margen de ganancia objetivo, basado en la f√≥rmula de sostenibilidad de Astralyxz.</p>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                <div class="space-y-5">
                    <div>
                        <div class="flex justify-between items-center">
                            <label for="prizeCost" class="font-medium text-gray-700">Costo del Premio (en CLP)</label>
                            <output for="prizeCost" id="prizeCostOutput" class="font-bold text-blue-600">$500.000</output>
                        </div>
                        <input type="range" id="prizeCost" min="10000" max="1000000" value="500000" step="10000" class="simulator-slider w-full mt-1">
                    </div>
                    <div>
                         <div class="flex justify-between items-center">
                            <label for="numTickets" class="font-medium text-gray-700">N¬∫ de Tickets M√≠nimos</label>
                            <output for="numTickets" id="numTicketsOutput" class="font-bold text-blue-600">200</output>
                        </div>
                        <input type="range" id="numTickets" min="50" max="10000" value="200" step="50" class="simulator-slider w-full mt-1">
                    </div>
                    <div>
                         <div class="flex justify-between items-center">
                            <label for="targetMargin" class="font-medium text-gray-700">Margen Objetivo</label>
                            <output for="targetMargin" id="targetMarginOutput" class="font-bold text-blue-600">80%</output>
                        </div>
                        <input type="range" id="targetMargin" min="50" max="95" value="80" step="1" class="simulator-slider w-full mt-1">
                    </div>
                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg mt-4">
                        <p class="text-sm text-blue-800">Precio M√≠nimo por Ticket (calculado)</p>
                        <p id="ticketPriceOutput" class="text-3xl font-extrabold text-blue-700">$12.500 CLP</p>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="simulator-chart"></canvas>
                </div>
            </div>
        </section>

        <section id="roadmap-section" class="mt-12">
             <h2 class="text-2xl font-bold text-center mb-8 text-gray-800">Hoja de Ruta Estrat√©gica</h2>
             <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-center">
                <div class="bg-white p-4 rounded-lg shadow border border-gray-200">
                    <div class="font-bold text-teal-600 mb-2">FASE 1</div>
                    <h4 class="font-semibold text-gray-700">MVP</h4>
                    <p class="text-xs text-gray-500 mt-1">Implementaci√≥n de econom√≠a y marketplace b√°sicos.</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow border border-gray-200">
                    <div class="font-bold text-teal-600 mb-2">FASE 2</div>
                    <h4 class="font-semibold text-gray-700">Crecimiento</h4>
                    <p class="text-xs text-gray-500 mt-1">Sistemas de referidos, rankings e influencers.</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow border border-gray-200">
                    <div class="font-bold text-teal-600 mb-2">FASE 3</div>
                    <h4 class="font-semibold text-gray-700">Escalabilidad</h4>
                    <p class="text-xs text-gray-500 mt-1">Publicidad segmentada y dropshipping optimizado.</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow border border-gray-200">
                    <div class="font-bold text-teal-600 mb-2">FASE 4</div>
                    <h4 class="font-semibold text-gray-700">Optimizaci√≥n</h4>
                    <p class="text-xs text-gray-500 mt-1">An√°lisis predictivo y ajuste din√°mico del modelo econ√≥mico.</p>
                </div>
             </div>
        </section>
    </div>

    <script>
        // --- L√ìGICA PARA EL DIAGRAMA DE FLUJO ECON√ìMICO ---
        const appData = {
            introduction: {
                title: 'Bienvenido al Coraz√≥n Econ√≥mico de Astralyxz',
                content: 'Esta es una simulaci√≥n interactiva del modelo econ√≥mico de la Astralyxz Coin (AC). Cada AC tiene un valor fijo de $100 CLP. Usa el diagrama de flujo superior para explorar los pilares que aseguran la estabilidad, rentabilidad y crecimiento sostenible de la plataforma.'
            },
            emission: {
                title: 'Fuentes de Emisi√≥n de Astralyxz Coins',
                content: `La creaci√≥n de nuevos Coins (AC) est√° estrictamente controlada y ligada a acciones que generan valor para la plataforma. Estas son las √∫nicas fuentes:`,
                points: [
                    '<strong>Compras directas:</strong> Usuarios adquieren AC con dinero real, generando ingresos inmediatos.',
                    '<strong>Recompensas por referidos:</strong> Se emiten Coins para incentivar la viralidad y el crecimiento org√°nico.',
                    '<strong>Cashback por participaci√≥n:</strong> Un 30% del valor de rifas perdidas se devuelve en AC para fomentar la retenci√≥n.',
                    '<strong>Premios en rifas:</strong> Los premios se conceden en AC, manteniendo el valor dentro del ecosistema.'
                ]
            },
            circulation: {
                title: 'Circulaci√≥n y Absorci√≥n de Coins',
                content: 'El sistema est√° dise√±ado para que los Coins fluyan constantemente, evitando acumulaciones y manteniendo una econom√≠a interna saludable. Los usos principales son:',
                points: [
                    '<strong>Participaci√≥n en Rifas:</strong> El principal motor de gasto. Cada ticket tiene un costo en AC.',
                    '<strong>Compras en Marketplace:</strong> Productos f√≠sicos (electr√≥nicos, etc.) disponibles para canje, incentivando la redenci√≥n de premios.',
                    '<strong>Incentivo Cruzado:</strong> Cada compra en el marketplace otorga un ticket de rifa gratis, cerrando el ciclo econ√≥mico.',
                    '<strong>Canje Inmediato:</strong> Los premios de rifas deben canjearse en 72 horas, forzando la circulaci√≥n r√°pida de los Coins ganados.'
                ]
            },
            control: {
                title: 'Control de Riesgos y Prevenci√≥n de Acumulaci√≥n',
                content: 'Para mantener el equilibrio y la justicia, se implementan varias reglas estrat√©gicas que previenen desbalances econ√≥micos y comportamientos predatorios:',
                points: [
                    '<strong>L√≠mites de Compra:</strong> Se limita la cantidad de AC que un usuario puede comprar para evitar la aparici√≥n de "ballenas".',
                    '<strong>Penalizaci√≥n por Inactividad:</strong> Los premios no canjeados en 72h pierden el 50% de su valor, combatiendo la acumulaci√≥n.',
                    '<strong>Restricci√≥n de Reutilizaci√≥n:</strong> Los AC ganados como premio no pueden usarse inmediatamente en nuevas rifas, evitando que un solo ganador domine el ecosistema.'
                ]
            }
        };

        const detailPanel = document.getElementById('detail-panel');
        const diagramNodes = document.querySelectorAll('.diagram-node');

        function updateDetailPanel(targetId) {
            const data = appData[targetId];
            if (!data) return;

            let pointsHTML = '';
            if (data.points) {
                pointsHTML = `<ul class="space-y-3 list-inside mt-4">${data.points.map(p => `<li class="flex items-start"><span class="text-teal-500 mr-2 mt-1">‚ñ∏</span><span>${p}</span></li>`).join('')}</ul>`;
            }
            detailPanel.innerHTML = `
                <div class="detail-panel-content">
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">${data.title}</h2>
                    <p class="text-gray-600">${data.content}</p>
                    ${pointsHTML}
                </div>
            `;
        }

        function handleNodeClick(event) {
            const targetId = event.currentTarget.dataset.target;
            diagramNodes.forEach(node => node.classList.remove('active'));
            event.currentTarget.classList.add('active');
            updateDetailPanel(targetId);
        }

        // --- L√ìGICA PARA EL SIMULADOR DE RENTABILIDAD ---
        const simulatorSliders = {
            prizeCost: document.getElementById('prizeCost'),
            numTickets: document.getElementById('numTickets'),
            targetMargin: document.getElementById('targetMargin'),
        };
        const simulatorOutputs = {
            prizeCost: document.getElementById('prizeCostOutput'),
            numTickets: document.getElementById('numTicketsOutput'),
            targetMargin: document.getElementById('targetMarginOutput'),
            ticketPrice: document.getElementById('ticketPriceOutput'),
        };
        let simulatorChart;

        function calculateTicketPrice() {
            const prizeCost = parseFloat(simulatorSliders.prizeCost.value);
            const numTickets = parseFloat(simulatorSliders.numTickets.value);
            const targetMargin = parseFloat(simulatorSliders.targetMargin.value) / 100;

            simulatorOutputs.prizeCost.textContent = `$${prizeCost.toLocaleString('es-CL')}`;
            simulatorOutputs.numTickets.textContent = `${numTickets.toLocaleString('es-CL')}`;
            simulatorOutputs.targetMargin.textContent = `${(targetMargin * 100).toFixed(0)}%`;

            if (numTickets > 0 && (1 - targetMargin) > 0) {
                const minPrice = (prizeCost / numTickets) / (1 - targetMargin);
                simulatorOutputs.ticketPrice.textContent = `$${minPrice.toLocaleString('es-CL', { maximumFractionDigits: 0 })} CLP`;
                
                const totalRevenue = minPrice * numTickets;
                updateSimulatorChart(prizeCost, totalRevenue);
            }
        }
        
        function updateSimulatorChart(cost, revenue) {
            if (simulatorChart) {
                simulatorChart.data.datasets[0].data[0] = cost;
                simulatorChart.data.datasets[1].data[0] = revenue;
                simulatorChart.update();
            }
        }

        function initializeSimulator() {
            const ctx = document.getElementById('simulator-chart').getContext('2d');
            simulatorChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Costo vs Ingreso'],
                    datasets: [{
                        label: 'Costo del Premio (CLP)',
                        data: [0],
                        backgroundColor: '#f59e0b',
                        borderWidth: 1,
                        borderColor: '#d97706'
                    }, {
                        label: 'Ingreso Total (CLP)',
                        data: [0],
                        backgroundColor: '#3182ce',
                        borderWidth: 1,
                        borderColor: '#2b6cb0'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Valor en Pesos Chilenos (CLP)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        tooltip: {
                             callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: $${context.raw.toLocaleString('es-CL')} CLP`;
                                }
                            }
                        }
                    }
                }
            });
            
            Object.values(simulatorSliders).forEach(slider => {
                slider.addEventListener('input', calculateTicketPrice);
            });
            calculateTicketPrice();
        }

        // INICIALIZACI√ìN DE TODA LA P√ÅGINA
        document.addEventListener('DOMContentLoaded', () => {
            // Inicializar el diagrama de flujo
            diagramNodes.forEach(node => node.addEventListener('click', handleNodeClick));
            const firstNode = diagramNodes[0];
            if (firstNode) {
                firstNode.classList.add('active');
                updateDetailPanel(firstNode.dataset.target);
            }
            
            // Inicializar el simulador
            initializeSimulator();
        });
    </script>
</body>
</html>
